!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=2)}([function(e,t){function i(e,t,i,n){let l=o(e,i);return 2==t.coefx?l[0]-=i.cols-n.cols:1==t.coefx&&(l[0]-=t.x-n.hcols),2==t.coefy?l[1]-=i.rows-n.rows:1==t.coefy&&(l[1]-=t.y-n.hrows),[l[0],l[1]]}function n(e,t,n,o){let l=i(e,t,n,o);if(l[0]>=0&&l[0]<=o.cols&&l[1]>=0&&l[1]<=o.rows)return[l[0],l[1]]}function o(e,t){return[(e-e%t.rows)/t.cols,e%t.cols]}const l={color:function(e,t,i,o,l){let s=n(e,i,o,l);s&&(l.ctx2.clearRect(l.CellSize*s[1],l.CellSize*s[0],l.CellSize,l.CellSize),l.ctx2.fillStyle=t,l.ctx2.fillRect(l.CellSize*s[1],l.CellSize*s[0],l.CellSize,l.CellSize))},allowed:function(e,t,i,o){let l=n(e,t,i,o);l&&(o.ctx1.clearRect(o.CellSize*l[1],o.CellSize*l[0],o.CellSize,o.CellSize),o.ctx1.fillStyle="#e9e9e9",o.ctx1.fillRect(o.CellSize*l[1],o.CellSize*l[0],o.CellSize,o.CellSize))},position:function(e,t,i,o){let l=n(e,t,i,o);l&&this.roundRect(o.ctx3,o.CellSize*l[1]+1.5*o.shift,o.CellSize*l[0]+1.5*o.shift,o.CellSize-3*o.shift,o.CellSize-3*o.shift,o.shift,o)},roundRect:function(e,t,i,n,o,l,s){e.strokeStyle="black",e.lineWidth=s.shift,e.beginPath(),e.moveTo(t+l,i),e.lineTo(t+n-l,i),e.quadraticCurveTo(t+n,i,t+n,i+l),e.lineTo(t+n,i+o-l),e.quadraticCurveTo(t+n,i+o,t+n-l,i+o),e.lineTo(t+l,i+o),e.quadraticCurveTo(t,i+o,t,i+o-l),e.lineTo(t,i+l),e.quadraticCurveTo(t,i,t+l,i),e.closePath(),e.stroke()}};e.exports={posinview:i,check:n,indextocoord:o,clear:function(e,t,i,o,l){let s=n(e,i,o,l);s&&t.clearRect(l.CellSize*s[1],l.CellSize*s[0],l.CellSize,l.CellSize)},render:l}},function(e,t,i){e.exports={askformove:function(e,t,i,n){t.flag&&(i.lastdir=e,n.emit("MovePlayer",e))},drawcell:function(e,t,n,o,l,s){n.colors[e]=t,window.Fill.init(i(0).check(e,o,n,l),t,n,l),s.emit("DrawCell",[e,t])}}},function(e,t,i){e.exports=i(3)},function(e,t,i){const n=io(),o=i(4),l=i(5),s=i(6),r=i(7),c=(i(8),i(0));i(9)(l,o,r,s,n),document.getElementById("login").addEventListener("click",(function(){n.emit("login",{user:document.getElementById("userName").value,pass:document.getElementById("Password").value})})),n.on("InitData",(function(e){o.init(e,l,r,s,n)})),n.on("NewPlayerPos",(function(e){l.position=e,window.Translate.init(o,s,l)})),n.on("NewPosition",(function(e){o.positions.push(e[1]),c.render.position(e[1],l,o,s),e[0]&&(o.positions.splice(o.positions.indexOf(e[0]),1),c.clear(e[0],s.ctx3,l,o,s))})),n.on("NewCell",(function(e){o.colors[e.position]=e.color,c.render.color(e.position,e.color,l,o,s)})),n.on("AllowedCells",(function(e){e.forEach((function(e){o.allowed.includes(e)||(o.allowed.push(e),c.render.allowed(e,l,o,s))}))})),n.on("message",(function(e){console.log(e)})),n.on("alert",(function(e){alert(e)})),n.on("error",(function(){alert("Error: Please try again!")}))},function(e,t){const i={duration:.2,init:function(e,t,n,o,l){this.colors=e.ColorList,this.positions=e.PositionList,this.allowed=e.allowedlist,this.rows=e.uiparams[0],this.cols=e.uiparams[1],this.flag=!0,t.init(e),o.init(),this.render(o,t),n.init(i,t,o,l)},update:function(e,t,n){n.update(e,i,t),t.update(e,n,i)},render:function(e,t){e.setup(),this.update(null,e,t),e.render(t,i)}};e.exports=i},function(e,t,i){const n={init:function(e){this.position=e.position,this.colors=e.colors,this.selectedcolor=e.colors[0],this.canvas=document.getElementById("playercanvas"),this.shadow=document.getElementById("shadow"),this.ctx=this.canvas.getContext("2d"),this.ctx.imageSmoothingEnabled=!1},update:function(e,t,o){let l=i(0).indextocoord(n.position,t);n.x=l[0],n.y=l[1],n.x<o.hcols?(n.coefx=0,n.vx=n.x):n.x>t.cols-o.hcols?(n.coefx=2,n.vx=n.x+o.cols-t.cols-2):(n.coefx=1,n.vx=o.hcols-1),n.y<o.hrows?(n.coefy=0,n.vy=n.y):n.y>t.rows-o.hrows?(n.coefy=2,n.vy=n.y+o.rows-t.rows-2):(n.coefy=1,n.vy=o.hrows-1),n.shadow.style.transitionDuration=n.canvas.style.transitionDuration=e?t.duration+"s":"0s",n.shadow.style.top=n.canvas.style.top=n.vx*o.CellSize+o.shift+"px",n.shadow.style.left=n.canvas.style.left=n.vy*o.CellSize+o.shift+"px",e||(n.canvas.width=n.canvas.height=o.CellSize-4*o.shift,n.shadow.style.width=n.shadow.style.height=o.CellSize-2*o.shift-2+"px",n.shadow.style.borderRadius=n.canvas.style.borderWidth=n.canvas.style.borderRadius=o.shift+"px")}};e.exports=n},function(e,t,i){const n=i(0).render,o={maxcells:51,startcells:15,mincells:11,init:function(){this.master=document.getElementById("master"),this.canvas=document.querySelectorAll(".mapcanvas"),this.ctx1=this.canvas[0].getContext("2d"),this.ctx2=this.canvas[1].getContext("2d"),this.ctx3=this.canvas[2].getContext("2d"),this.ctx1.imageSmoothingEnabled=this.ctx2.imageSmoothingEnabled=this.ctx3.imageSmoothingEnabled=!1,this.topmask=document.getElementById("topmask"),this.bottommask=document.getElementById("bottommask"),this.leftmask=document.getElementById("leftmask"),this.rightmask=document.getElementById("rightmask")},setup:function(){let e=window.innerWidth,t=window.innerHeight;o.rows||(o.rows=o.startcells),o.cols||(o.cols=o.startcells),o.rows<=o.mincells&&(o.rows=o.mincells),o.cols<=o.mincells&&(o.cols=o.mincells),o.rows>=o.maxcells&&(o.rows=o.maxcells),o.cols>=o.maxcells&&(o.cols=o.maxcells),e>t?(o.Smargin=Math.round(.01*e),o.Lmargin=Math.round(.05*e),e-=o.Lmargin,o.cols=Math.round(o.rows*t/e),o.CellSize=Math.round(e/(o.rows-2)),o.marginLeft=o.Smargin,o.marginRight=o.Smargin+o.Lmargin,o.marginTop=o.Smargin,o.marginBottom=o.Smargin):(o.Smargin=Math.round(.01*t),o.Lmargin=Math.round(.075*t),t-=o.Lmargin,o.rows=Math.round(o.cols*e/t),o.CellSize=Math.round(t/(o.cols-2)),o.marginLeft=o.Smargin,o.marginRight=o.Smargin,o.marginTop=o.Smargin,o.marginBottom=o.Smargin+o.Lmargin),o.cols%2==0&&o.cols++,o.rows%2==0&&o.rows++,o.hrows=(o.rows-1)/2,o.hcols=(o.cols-1)/2,o.lw=Math.round(o.CellSize/6),o.width=o.CellSize*(o.rows-2),o.height=o.CellSize*(o.cols-2),o.shift=Math.round(o.CellSize/8),o.master.style.width=o.width+"px",o.master.style.height=o.height+"px";for(let e=0;e<3;e++)o.canvas[e].width=o.width+2*o.CellSize,o.canvas[e].height=o.height+2*o.CellSize;o.topmask.style.height=o.marginTop+"px",o.bottommask.style.height=o.marginBottom+"px",o.leftmask.style.width=o.marginLeft+"px",o.rightmask.style.width=o.marginRight+"px"},update:function(e,t,i){if(o.master.style.transitionDuration=e?i.duration+"s":"0s",0==t.coefx?o.master.style.marginTop=o.marginTop+"px":2==t.coefx?o.master.style.marginTop=window.innerHeight-o.height-o.marginBottom+"px":window.innerHeight<window.innerWidth?o.master.style.marginTop=Math.round((window.innerHeight-o.height)/2)+"px ":o.master.style.marginTop="0px ",0==t.coefy?o.master.style.marginLeft=o.marginLeft+"px":2==t.coefy?o.master.style.marginLeft=window.innerWidth-o.width-o.marginRight+"px":window.innerHeight>window.innerWidth?o.master.style.marginLeft=Math.round((window.innerWidth-o.width)/2)+"px ":o.master.style.marginLeft="0px ",!e)return;let n;if("up"==t.lastdir&&t.x+1>=o.hcols&&t.x+1<=i.cols-o.hcols?n="Y(":"down"==t.lastdir&&t.x>=o.hcols&&t.x<=i.cols-o.hcols?n="Y(-":"left"==t.lastdir&&t.y+1>=o.hrows&&t.y+1<=i.rows-o.hrows?n="X(":"right"==t.lastdir&&t.y>=o.hrows&&t.y<=i.rows-o.hrows&&(n="X(-"),n)for(let e=0;e<3;e++)o.canvas[e].style.transitionDuration=i.duration+"s",o.canvas[e].style.transform="translate"+n+o.CellSize+"px)"},render:function(e,t){o.ctx1.clearRect(0,0,o.canvas[1].width,o.canvas[1].height),o.ctx2.clearRect(0,0,o.canvas[1].width,o.canvas[1].height),o.ctx3.clearRect(0,0,o.canvas[1].width,o.canvas[1].height);for(let t=0;t<3;t++)o.canvas[t].style.transitionDuration="0s",o.canvas[t].style.transform="translate(0, 0)",o.canvas[t].style.top="-"+o.CellSize*e.coefx+"px",o.canvas[t].style.left="-"+o.CellSize*e.coefy+"px";t.allowed.forEach((function(i){n.allowed(i,e,t,o)}));let i=t.colors.length;for(let l=0;l<i;l++)null!==t.colors[l]&&n.color(l,t.colors[l],e,t,o);t.positions.forEach((function(i){n.position(i,e,t,o)}))}};e.exports=o},function(e,t,i){const n={init:function(e,t,o,l){this.volet=document.getElementById("volet"),this.zin=document.getElementById("zoomin"),this.zout=document.getElementById("zoomout"),this.elem=document.documentElement,this.full={button:document.getElementById("full"),flag:!1},this.cs=[document.getElementById("c1"),document.getElementById("c2"),document.getElementById("c3")],this.cs.forEach((function(s){s.style.background=t.colors[n.cs.indexOf(s)],s.addEventListener("click",(function(){n.select(s,t),i(1).drawcell(t.position,t.selectedcolor,e,t,o,l)}))})),this.zin.addEventListener("click",(function(){e.flag&&n.zoomin(e,o,t)})),this.zout.addEventListener("click",(function(){e.flag&&n.zoomout(e,o,t)})),window.addEventListener("resize",(function(){e.render(o,t)})),window.addEventListener("orientationchange",(function(){e.render(o,t)})),this.full.button.addEventListener("click",(function(){n.fullscreen()})),this.select(c1,t),this.hidelobby()},select:function(e,t){e.style.transform="scale(1)",e.style.borderWidth="2px",t.selectedcolor=t.colors[this.cs.indexOf(e)],t.canvas.style.background=t.selectedcolor,this.cs.filter((function(t){return t!==e})).forEach((function(e){e.style.borderWidth="1px",e.style.transform="scale(0.8)"}))},fullscreen:function(){this.full.flag?(this.full.flag=!1,document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()):(this.full.flag=!0,this.elem.requestFullscreen?this.elem.requestFullscreen():this.elem.mozRequestFullScreen?this.elem.mozRequestFullScreen():this.elem.webkitRequestFullscreen?this.elem.webkitRequestFullscreen():this.elem.msRequestFullscreen&&this.elem.msRequestFullscreen())},hidelobby:function(){volet.style.opacity="0",setTimeout((function(){volet.style.display="none"}),500)},zoomin:function(e,t,i){t.rows-=2,t.cols-=2,e.render(t,i)},zoomout:function(e,t,i){t.rows+=2,t.cols+=2,e.render(t,i)}};e.exports=n},function(e,t){Fill={init:function(e,t,i,n){i.flag=!1,this.divx=0,this.divy=0,this.posx=n.CellSize*e[1],this.posy=n.CellSize*(e[0]+1),this.lw=n.lw,n.ctx2.strokeStyle=t,n.ctx2.lineWidth=n.lw,this.frame(i,n)},frame:function(e,t){Fill.divx==t.CellSize&&(Fill.divy+=Fill.lw,Fill.divx=0),Fill.divx+=Math.round(t.CellSize/8),Fill.divx>=.65*t.CellSize&&(Fill.divx=t.CellSize),Fill.divy>4.5*t.CellSize/6&&(Fill.lw=t.CellSize-Fill.divy,t.ctx2.lineWidth=Fill.lw,Fill.divy=t.CellSize-Fill.lw),t.ctx2.strokeStyle=Fill.color,t.ctx2.beginPath(),t.ctx2.moveTo(Fill.posx,Fill.posy-Fill.divy-Fill.lw/2),t.ctx2.lineTo(Fill.posx+Fill.divx,Fill.posy-Fill.divy-Fill.lw/2),t.ctx2.stroke(),Fill.divy>4.5*t.CellSize/6&&Fill.divx==t.CellSize?e.flag=!0:Fill.animationFrame=window.requestAnimationFrame((function(){Fill.frame(e,t)}))}},Translate={init:function(e,t,i){e.flag=!1,e.update(!0,t,i),this.start=Date.now(),this.frame(e,t,i)},frame:function(e,t,i){if(Translate.delta=(Date.now()-Translate.start)/1e3,Translate.delta>=e.duration)return t.render(i,e),void(e.flag=!0);Translate.animationFrame=window.requestAnimationFrame((function(){Translate.frame(e,t,i)}))}},window.Fill=window.Fill||{},window.Translate=window.Translate||{},function(){for(var e=0,t=["ms","moz","webkit","o"],i=0;i<t.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[t[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[i]+"CancelAnimationFrame"]||window[t[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,i){var n=(new Date).getTime(),o=Math.max(0,16-(n-e)),l=window.setTimeout((function(){t(n+o)}),o);return e=n+o,l}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}()},function(e,t,i){const n=i(1);e.exports=function(e,t,i,o,l){document.addEventListener("keydown",(function(s){if(t.flag)switch(s.keyCode){case 32:n.drawcell(e.position,e.selectedcolor,t,e,o,l);break;case 37:i.zoomin(t,o,e);break;case 39:i.zoomout(t,o,e);break;case 38:e.selectedcolor==e.colors[0]?i.select(c3,e):e.selectedcolor==e.colors[1]?i.select(c1,e):i.select(c2,e);break;case 40:e.selectedcolor==e.colors[0]?i.select(c2,e):e.selectedcolor==e.colors[1]?i.select(c3,e):i.select(c1,e);break;case 81:n.askformove("left",t,e,l);break;case 90:n.askformove("up",t,e,l);break;case 68:n.askformove("right",t,e,l);break;case 83:n.askformove("down",t,e,l)}})),document.addEventListener("click",(function(e){"[object HTMLButtonElement]"==document.activeElement.toString()&&document.activeElement.blur()}))}}]);